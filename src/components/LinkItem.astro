---
interface Props {
  title: string;
  href?: string;
  subtext?: string;
  description?: string;
  date?: string;
  external?: boolean;
  github?: string;
  writeup?: string;
}

const { title, href, subtext, description, date, external = false, github, writeup } = Astro.props;

// Split title by em-dash to handle Role/Company stacking on mobile
const parts = title.split(' — ');
---
<div class="group">
  <div class="flex flex-col md:flex-row md:items-baseline md:justify-between mb-3 md:mb-1 gap-1 md:gap-0">
    <div class="flex flex-col md:flex-row md:items-baseline gap-1 md:gap-3">
      <div class="flex items-start justify-between md:justify-start gap-3">
        {parts.length > 1 ? (
          <div>
            {href ? (
              <a 
                href={href} 
                target={external ? "_blank" : undefined}
                rel={external ? "noopener noreferrer" : undefined}
                class="brandur-link text-lg font-sans font-medium inline-block mb-1 md:mb-0 md:inline md:mr-2"
                style="color: var(--c-text-main);"
              >
                {parts[0]}
              </a>
            ) : (
              <span class="text-lg font-sans font-medium block mb-1 md:mb-0 md:inline md:mr-2" style="color: var(--c-text-main);">
                {parts[0]}
              </span>
            )}
            
            <span class="hidden md:inline mr-2" style="color: var(--c-text-faint);">—</span>
            <span class="block md:inline text-base md:text-lg font-normal md:font-medium italic" style="color: var(--c-text-secondary);">
              {parts[1]}
            </span>
          </div>
        ) : (
          href ? (
            <a 
              href={href}
              target={external ? "_blank" : undefined}
              rel={external ? "noopener noreferrer" : undefined}
              class="brandur-link text-lg font-sans font-medium"
              style="color: var(--c-text-main);"
            >
              {title}
              {subtext && <span class="block md:inline md:ml-2 text-base font-normal no-underline" style="color: var(--c-text-faint);">{subtext}</span>}
            </a>
          ) : (
            <span class="text-lg font-sans font-medium" style="color: var(--c-text-main);">
              {title}
              {subtext && <span class="block md:inline md:ml-2 text-base font-normal" style="color: var(--c-text-faint);">{subtext}</span>}
            </span>
          )
        )}
        {date && <span class="text-sm font-sans italic md:hidden pt-1" style="color: var(--c-text-faint);">{date}</span>}
      </div>

      <div class="flex items-baseline gap-3">
        {github && (
          <a 
            href={github} 
            target="_blank" 
            rel="noopener noreferrer" 
            class="text-xs secondary-link font-sans group-hover/link:text-text-main"
          >
            Repository <span class="text-[10px]">↗</span>
          </a>
        )}
        {writeup && (
          <a 
            href={writeup} 
            target="_blank" 
            rel="noopener noreferrer" 
            class="text-xs secondary-link font-sans group-hover/link:text-text-main"
          >
            Writeup <span class="text-[10px]">↗</span>
          </a>
        )}
      </div>
    </div>
    {date && <span class="text-sm font-sans italic hidden md:block" style="color: var(--c-text-faint);">{date}</span>}
  </div>
  {description && (
    <p class="text-sm leading-relaxed max-w-xl" style="color: var(--c-text-muted);">
      {description}
    </p>
  )}
</div>
